pipeline {
    agent any 

    parameters {
        string(name: 'FILE_NAME', description: 'Nama file yang ingin dicari (misal: example, log, etc.)')
    }

    stages {
        stage('Search Files') {
            steps {
                script {
                    def fileName = params.FILE_NAME


                    stage('Search File') {
                        try {
                            
                            def files = sh(script: "find / -type f -name '*${fileName}.*' 2>/dev/null || true", returnStdout: true).trim()
                            
                            stage('Result Search') {
                                if (files) {
                                    echo "File(s) found with name containing '${fileName}':\n${files}"
                                } else {
                                    echo "No files found with name containing '${fileName}'."
                                }
                            }
                        } catch (Exception e) {
                            
                            echo "An error occurred during file search: ${e.message}"
                            currentBuild.result = 'FAILURE'
                        }
                    }
                }
            }
        }
    }
}

